<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Basic eigenmotion · Penning.jl</title><script data-outdated-warner src="../../../assets/warner.js"></script><link rel="canonical" href="https://github.com/jherkenhoff/Penning.jl/generated/examples/basic_eigenmotion/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">Penning.jl</a></span></div><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><a class="tocitem" href="../../../getting_started/">Getting Started</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Basic eigenmotion</a><ul class="internal"><li><a class="tocitem" href="#Install-dependencies"><span>Install dependencies</span></a></li><li><a class="tocitem" href="#Import-dependencies"><span>Import dependencies</span></a></li><li><a class="tocitem" href="#Define-trap-parameters"><span>Define trap parameters</span></a></li><li><a class="tocitem" href="#Instantiate-trap"><span>Instantiate trap</span></a></li><li><a class="tocitem" href="#Instantiate-setup"><span>Instantiate setup</span></a></li><li><a class="tocitem" href="#Instantiate-simulation-object"><span>Instantiate simulation object</span></a></li><li><a class="tocitem" href="#Run-simulation"><span>Run simulation</span></a></li><li><a class="tocitem" href="#Retreive-simulation-data"><span>Retreive simulation data</span></a></li><li><a class="tocitem" href="#Results"><span>Results</span></a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Setting up the simulation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../simulation_setup/overview/">Overview</a></li><li><a class="tocitem" href="../../../simulation_setup/traps/">Traps</a></li><li><a class="tocitem" href="../../../simulation_setup/fields/">Fields</a></li><li><a class="tocitem" href="../../../simulation_setup/particles/">Particles</a></li><li><a class="tocitem" href="../../../simulation_setup/interactions/">Particle interactions</a></li><li><a class="tocitem" href="../../../simulation_setup/electrodes/">Detection electrodes</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Running the simulation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../simulation/overview/">Overview</a></li><li><a class="tocitem" href="../../../simulation/integrators/">Particle integrators</a></li><li><a class="tocitem" href="../../../simulation/distributed_parallel/">Distributed / parallel computing</a></li><li><a class="tocitem" href="../../../simulation/observables/">Observables</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Output writers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../output_writers/overview/">Overview</a></li><li><a class="tocitem" href="../../../output_writers/memory_writer/">Writing to memory</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Circuit cosimulation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../circuit_cosimulation/overview/">Overview</a></li><li><a class="tocitem" href="../../../circuit_cosimulation/theory/">Theory</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox"/><label class="tocitem" for="menuitem-8"><span class="docs-label">Utils</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../utils/schedules/">Schedules</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-9" type="checkbox"/><label class="tocitem" for="menuitem-9"><span class="docs-label">Validation studies</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-9-1" type="checkbox"/><label class="tocitem" for="menuitem-9-1"><span class="docs-label">Ion detection</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../validation/resistor_noiseless/">Noiseless Resistor</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Basic eigenmotion</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Basic eigenmotion</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/jherkenhoff/Penning.jl/blob/main/examples/basic_eigenmotion.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Basic-eigenmotion-example"><a class="docs-heading-anchor" href="#Basic-eigenmotion-example">Basic eigenmotion example</a><a id="Basic-eigenmotion-example-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-eigenmotion-example" title="Permalink"></a></h1><p>In this example, we are going to simulate the motion of a single ion stored inside a Penning trap. This example can be considered as the <em>hello world</em> of <code>Penning.jl</code>. You will learn how to:</p><ul><li>Set up a simple simulation with one ion in an ideal Penning trap</li><li>Store simulation data (in this case the position of the ion) to memory</li><li>Access the simulation data</li><li>Plot the simulated ion motion</li></ul><h2 id="Install-dependencies"><a class="docs-heading-anchor" href="#Install-dependencies">Install dependencies</a><a id="Install-dependencies-1"></a><a class="docs-heading-anchor-permalink" href="#Install-dependencies" title="Permalink"></a></h2><p>First let&#39;s make sure we have all required packages installed.</p><pre><code class="language-julia hljs">using Pkg
pkg&quot;add Penning, Plots&quot;</code></pre><h2 id="Import-dependencies"><a class="docs-heading-anchor" href="#Import-dependencies">Import dependencies</a><a id="Import-dependencies-1"></a><a class="docs-heading-anchor-permalink" href="#Import-dependencies" title="Permalink"></a></h2><p>In order to use the functionality of <code>Penning.jl</code>, we have to tell Julia that we want to use this package. While we are at it, lets also import the <a href="https://docs.juliaplots.org/latest/">Plots</a> package:</p><pre><code class="language- hljs">using Penning
using Plots</code></pre><h2 id="Define-trap-parameters"><a class="docs-heading-anchor" href="#Define-trap-parameters">Define trap parameters</a><a id="Define-trap-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Define-trap-parameters" title="Permalink"></a></h2><p>Define some trap parameters for the ideal trap. As you can see, the names of the constants contain unicode characters, which are nice to read, but may seem hard to type at first glance. However, if you are a Julia developer, chances are high that you are using <a href="https://code.visualstudio.com/">Visual Studio Code</a> with the <a href="https://code.visualstudio.com/docs/languages/julia">Julia extension</a>, which makes typing unicode characters a breeze: You just have to type <code>U\_0</code> and hit enter or tab and VS Code will add the correct unicode symbol.</p><pre><code class="language-julia hljs">const U₀ = -50.0
const c₂ = -14960.0
const B₀ = 1.0</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.0</code></pre><h2 id="Instantiate-trap"><a class="docs-heading-anchor" href="#Instantiate-trap">Instantiate trap</a><a id="Instantiate-trap-1"></a><a class="docs-heading-anchor-permalink" href="#Instantiate-trap" title="Permalink"></a></h2><p>The <a href="generated/examples/@ref"><code>Trap</code></a> object contains all things related to a single Penning trap. In this example, we are using an <a href="../../../simulation_setup/fields/#Penning.Fields.IdealTrapField"><code>IdealTrapField</code></a> with the previously specified parameters. For more complex simulations, this is the place where you would also add for example excitation fields or field imperfections.</p><p>Since an empty trap would be quite boring, we have to specify the particle species and initial positions and velocities of all particles contained in the simulation. <code>Penning.jl</code> groups particles of same particle species into <a href="../../../simulation_setup/particles/#Penning.Particles.ParticleCollection"><code>ParticleCollection</code></a>s, which is a concept that becomes important if you want to specify and control inter-particle interactions. But since we only want to simulate a single ion we only need a single particle collection. In this example, we are using an ion with mass 187 u (atomic mass unit) and charge state 30 (in elementary charge unit). The initial position and velocity have to be specified in meters and meters per second.</p><pre><code class="language-julia hljs">trap = Trap(
    fields = (
        IdealTrapField(U₀, c₂, B₀),
    ),
    particles = (
        ParticleCollection(Ion(187, 30), [[50e-6, 0, 50e-6]], [[100, 0, 0]]),
    )
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Trap{Tuple{IdealTrapField{ConstantParameter{Float64}, ConstantParameter{Float64}, ConstantParameter{Float64}}}, Tuple{ParticleCollection}, NamedTuple{(), Tuple{}}, NamedTuple{(), Tuple{}}}((IdealTrapField{ConstantParameter{Float64}, ConstantParameter{Float64}, ConstantParameter{Float64}}(ConstantParameter{Float64}(-50.0), ConstantParameter{Float64}(-14960.0), ConstantParameter{Float64}(1.0)),), (ParticleCollection(Species(3.105208054542e-25, 4.806529902e-18), StaticArraysCore.MVector{3, Float64}[[5.0e-5, 0.0, 5.0e-5]], StaticArraysCore.MVector{3, Float64}[[100.0, 0.0, 0.0]], StaticArraysCore.MVector{3, Float64}[[0.0, 0.0, 0.0]], StaticArraysCore.MVector{3, Float64}[[0.0, 0.0, 0.0]], [0.0, 0.0, 0.0]),), NamedTuple(), NamedTuple())</code></pre><h2 id="Instantiate-setup"><a class="docs-heading-anchor" href="#Instantiate-setup">Instantiate setup</a><a id="Instantiate-setup-1"></a><a class="docs-heading-anchor-permalink" href="#Instantiate-setup" title="Permalink"></a></h2><p>The following code instantiates a <a href="generated/examples/@ref"><code>Setup</code></a> object, which contains all &quot;subsystems&quot; that should be included in this simulation setup. In this example, we only want to simulate our previously instantiated trap, but in more complex simulations this would be the place where you would for example add multiple traps, add electrical circuits and specify their connections.</p><pre><code class="language-julia hljs">setup = Setup(
    traps = (
        trap,
    )
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Setup{Tuple{Trap{Tuple{IdealTrapField{ConstantParameter{Float64}, ConstantParameter{Float64}, ConstantParameter{Float64}}}, Tuple{ParticleCollection}, NamedTuple{(), Tuple{}}, NamedTuple{(), Tuple{}}}}, NamedTuple{(), Tuple{}}, NamedTuple{(), Tuple{}}}((Trap{Tuple{IdealTrapField{ConstantParameter{Float64}, ConstantParameter{Float64}, ConstantParameter{Float64}}}, Tuple{ParticleCollection}, NamedTuple{(), Tuple{}}, NamedTuple{(), Tuple{}}}((IdealTrapField{ConstantParameter{Float64}, ConstantParameter{Float64}, ConstantParameter{Float64}}(ConstantParameter{Float64}(-50.0), ConstantParameter{Float64}(-14960.0), ConstantParameter{Float64}(1.0)),), (ParticleCollection(Species(3.105208054542e-25, 4.806529902e-18), StaticArraysCore.MVector{3, Float64}[[5.0e-5, 0.0, 5.0e-5]], StaticArraysCore.MVector{3, Float64}[[100.0, 0.0, 0.0]], StaticArraysCore.MVector{3, Float64}[[0.0, 0.0, 0.0]], StaticArraysCore.MVector{3, Float64}[[0.0, 0.0, 0.0]], [0.0, 0.0, 0.0]),), NamedTuple(), NamedTuple()),), NamedTuple(), NamedTuple(), Clock: time = 0 seconds, iteration = 0
)</code></pre><h2 id="Instantiate-simulation-object"><a class="docs-heading-anchor" href="#Instantiate-simulation-object">Instantiate simulation object</a><a id="Instantiate-simulation-object-1"></a><a class="docs-heading-anchor-permalink" href="#Instantiate-simulation-object" title="Permalink"></a></h2><p>The <a href="generated/examples/@ref"><code>Simulation</code></a> object contains a single reference to a <a href="generated/examples/@ref"><code>Setup</code></a> object and is otherwise responsible for  storing information about how the simulation is performed. Here, we specify that we want to use a time step (<code>dt</code>) of 20 ns and specify which data we want to save during simulation. In <code>Penning.jl</code>, data is stored using &quot;output writers&quot;, which offers various &quot;data storage backends&quot;. In this case we are using a <a href="generated/examples/@ref"><code>MemoryWriter</code></a>, which stores data into system memory (RAM).</p><p>The code <code>PositionObservable()</code> tells our MemoryWriter that we want to store the position of a particle. The code <code>SingleParticleSelection</code> selects the particle of which we want to save the position. (Note that the first index in Julia is 1, not 0)</p><p>The code <code>IterationInterval(1)</code> specifies the times at which the specified observable is to be saved. In this case, we want to store data at every simulation iteration.</p><pre><code class="language-julia hljs">sim = Simulation(
    setup,
    dt=20e-9,
    output_writers = (
        MemoryWriter(
            PositionObservable(),
            SingleParticleSelection(trap=1, particle_collection=1, particle_index=1),
            IterationInterval(1)
        ),
    )
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Simulation{NamedTuple{(), Tuple{}}, Tuple{MemoryWriter{PositionObservable, SingleParticleSelection{Int64, Int64}, Vector{Float64}}}, NamedTuple{(), Tuple{}}}(Setup{Tuple{Trap{Tuple{IdealTrapField{ConstantParameter{Float64}, ConstantParameter{Float64}, ConstantParameter{Float64}}}, Tuple{ParticleCollection}, NamedTuple{(), Tuple{}}, NamedTuple{(), Tuple{}}}}, NamedTuple{(), Tuple{}}, NamedTuple{(), Tuple{}}}((Trap{Tuple{IdealTrapField{ConstantParameter{Float64}, ConstantParameter{Float64}, ConstantParameter{Float64}}}, Tuple{ParticleCollection}, NamedTuple{(), Tuple{}}, NamedTuple{(), Tuple{}}}((IdealTrapField{ConstantParameter{Float64}, ConstantParameter{Float64}, ConstantParameter{Float64}}(ConstantParameter{Float64}(-50.0), ConstantParameter{Float64}(-14960.0), ConstantParameter{Float64}(1.0)),), (ParticleCollection(Species(3.105208054542e-25, 4.806529902e-18), StaticArraysCore.MVector{3, Float64}[[5.0e-5, 0.0, 5.0e-5]], StaticArraysCore.MVector{3, Float64}[[100.0, 0.0, 0.0]], StaticArraysCore.MVector{3, Float64}[[0.0, 0.0, 0.0]], StaticArraysCore.MVector{3, Float64}[[0.0, 0.0, 0.0]], [0.0, 0.0, 0.0]),), NamedTuple(), NamedTuple()),), NamedTuple(), NamedTuple(), Clock: time = 0 seconds, iteration = 0
), ModifiedBorisPusher(), 2.0e-8, NamedTuple(), (Memory writer
├── Schedule: IterationInterval(1)
└── Entry count: 0,), NamedTuple(), false, 0.0)</code></pre><h2 id="Run-simulation"><a class="docs-heading-anchor" href="#Run-simulation">Run simulation</a><a id="Run-simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Run-simulation" title="Permalink"></a></h2><p>Its finally time to run the simulation! Just specify how long you want to simulate and lean back (but not for too long - <code>Penning.jl</code> is fast 😉). Take a look at the documentation of <a href="generated/examples/@ref"><code>run!</code></a> for further stop conditions.</p><pre><code class="language- hljs">run!(sim, run_until_time=10e-6)</code></pre><h2 id="Retreive-simulation-data"><a class="docs-heading-anchor" href="#Retreive-simulation-data">Retreive simulation data</a><a id="Retreive-simulation-data-1"></a><a class="docs-heading-anchor-permalink" href="#Retreive-simulation-data" title="Permalink"></a></h2><p>Data stored inside a <a href="generated/examples/@ref"><code>MemoryWriter</code></a> can be accessed in the following way:</p><pre><code class="language- hljs">r = sim.output_writers[1].mem
t = sim.output_writers[1].t

x = getindex.(r, 1)
y = getindex.(r, 2)
z = getindex.(r, 3)

plot(t*1e6, z*1e6)
xlabel!(&quot;\$t\$ / ms&quot;)
ylabel!(&quot;Axial position / µm&quot;)
savefig(joinpath(@__DIR__, &quot;img/basic_eigenmotion_z.png&quot;))


plot(t*1e6, x*1e6)
xlabel!(&quot;\$t\$ / ms&quot;)
ylabel!(&quot;X position / µm&quot;)
savefig(joinpath(@__DIR__, &quot;img/basic_eigenmotion_x.png&quot;))</code></pre><h2 id="Results"><a class="docs-heading-anchor" href="#Results">Results</a><a id="Results-1"></a><a class="docs-heading-anchor-permalink" href="#Results" title="Permalink"></a></h2><p><img src="img/basic_eigenmotion_z.png" alt/> <img src="img/basic_eigenmotion_x.png" alt/></p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../../getting_started/">« Getting Started</a><a class="docs-footer-nextpage" href="../../../simulation_setup/overview/">Overview »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.16 on <span class="colophon-date" title="Wednesday 19 October 2022 08:39">Wednesday 19 October 2022</span>. Using Julia version 1.8.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
