<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Theory · Penning.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://github.com/jherkenhoff/Penning.jl/circuit_cosimulation/theory/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Penning.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../getting_started/">Getting Started</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/examples/basic_eigenmotion/">Basic eigenmotion</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Setting up the simulation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../simulation_setup/overview/">Overview</a></li><li><a class="tocitem" href="../../simulation_setup/setup/">Setup</a></li><li><a class="tocitem" href="../../simulation_setup/traps/">Traps</a></li><li><a class="tocitem" href="../../simulation_setup/fields/">Fields</a></li><li><a class="tocitem" href="../../simulation_setup/particles/">Particles</a></li><li><a class="tocitem" href="../../simulation_setup/interactions/">Particle interactions</a></li><li><a class="tocitem" href="../../simulation_setup/electrodes/">Detection electrodes</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Running the simulation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../simulation/overview/">Overview</a></li><li><a class="tocitem" href="../../simulation/integrators/">Particle integrators</a></li><li><a class="tocitem" href="../../simulation/distributed_parallel/">Distributed / parallel computing</a></li><li><a class="tocitem" href="../../simulation/observables/">Observables</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Output writers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../output_writers/overview/">Overview</a></li><li><a class="tocitem" href="../../output_writers/memory_writer/">Writing to memory</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox" checked/><label class="tocitem" for="menuitem-7"><span class="docs-label">Circuit cosimulation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../overview/">Overview</a></li><li class="is-active"><a class="tocitem" href>Theory</a><ul class="internal"><li><a class="tocitem" href="#State-space-representation"><span>State-space representation</span></a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox"/><label class="tocitem" for="menuitem-8"><span class="docs-label">Utils</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../utils/schedules/">Schedules</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-9" type="checkbox"/><label class="tocitem" for="menuitem-9"><span class="docs-label">Validation studies</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-9-1" type="checkbox"/><label class="tocitem" for="menuitem-9-1"><span class="docs-label">Ion detection</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/validation/resistor_noiseless/">Noiseless Resistor</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Circuit cosimulation</a></li><li class="is-active"><a href>Theory</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Theory</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/jherkenhoff/Penning.jl/blob/master/docs/src/circuit_cosimulation/theory.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h2 id="State-space-representation"><a class="docs-heading-anchor" href="#State-space-representation">State-space representation</a><a id="State-space-representation-1"></a><a class="docs-heading-anchor-permalink" href="#State-space-representation" title="Permalink"></a></h2><p>In Penning.jl, circuits are implemented in <a href="https://en.wikipedia.org/wiki/State-space_representation">state-space representation</a>, which is a technique to describe and solve systems of differentials equations in the time domain.</p><h3 id="Theory"><a class="docs-heading-anchor" href="#Theory">Theory</a><a id="Theory-1"></a><a class="docs-heading-anchor-permalink" href="#Theory" title="Permalink"></a></h3><p>In general, electrical circuits can be described as a <span>$n$</span>th-order ordinary differential equation with <span>$n$</span> concentrated energy reservoirs. In state-space representation, this equation is decomposed into <span>$n$</span> 1st-order differential equations and put into a matrix/vector representation.</p><p>The <strong>state</strong> of such a system is fully described by the energy content of its <span>$n$</span> energy reservoirs, called the state variables. State variables are, for example, the voltage of a capacitor, the current in an inductor, in a spring-mass system the deflection of the spring or the velocity of the mass. In state-space representation the individual state variables are composed into a state vector <span>$x$</span>.</p><p>The <strong>behaviour</strong> of such a system is fully described by a set of system-matrices:</p><ul><li>The state matrix <span>$\mathbf{A}$</span> describes how the state vector changes depending on the current state vector</li><li>The input matrix <span>$\mathbf{B}$</span> describes how the state vector changes depending on the current input vector</li><li>The output matrix <span>$\mathbf{C}$</span> translates the current state vector into an output vector</li><li>The feedthrough matrix <span>$\mathbf{D}$</span> translates the current input vector into an output vector</li></ul><p>The <strong>inputs</strong> and <strong>outputs</strong> of a system modeled in state-space representation are encapsulated in the input and output vectors <span>$i$</span> and <span>$u$</span>. While in general state-space modeling there are no restrictions on the physical units associated with the inputs and outputs, for Penning.jl they are fixed: The circuit-cosimulation functionality in Penning.jl is solely designed to calculate the voltages on electrodes of a Penning-trap as a function of its induced image currents. The induced currents are calculated during particle simulation, which is why we can treat it as a given input quantity for the circuit cosimulation. Our model has to accept the induced currents as an input and should output the associated voltages (which is why the input vector is named <span>$i$</span> and the output vector is named <span>$u$</span>). Care must be taken when a circuit provides multiple inputs and outputs. In that case, the current on the first input must correspond to the voltage on the first output, and so on. In sloppy mathematical notation, we could write this as</p><p class="math-container">\[\left[ \begin{array}{c}
u_\textnormal{electrode1}(t) \\
u_\textnormal{electrode2}(t)
\end{array} \right]
 = \textnormal{Circuit}\left(\left[ \begin{array}{c}
i_\textnormal{electrode1}(t) \\
i_\textnormal{electrode2}(t)
\end{array} \right]\right)\]</p><p>for an examplary circuit with two electrode-connections.</p><p>The state-space representation is often visualized as a block diagram, showing the interplay between system-matrices and vectors:</p><p><img src="../state_space_diagram.svg" alt/></p><p>It must be noted that the blocks labeled <span>$x_n$</span> and <span>$u_n$</span> do not comply with the common state-space representation, but are an extension for Penning.jl to model <strong>noise</strong>:</p><ul><li>The vector <span>$x_n$</span> models noise that is added to the state vector</li><li>The vector <span>$u_n$</span> models noise that is added to the output vector</li></ul><p>With all these definitions out of the way, the state-space representation can be algebraicly described using the <strong>state equation</strong></p><p class="math-container">\[\dot{\mathbf{x}}(t) = \mathbf{A}(t) \mathbf{x}(t) + \mathbf{B}(t) \mathbf{i}(t) + \mathbf{x}_n(t)\]</p><p>and the <strong>output equation</strong></p><p class="math-container">\[\mathbf{u}(t) = \mathbf{C}(t) \mathbf{x}(t) + \mathbf{D}(t) \mathbf{i}(t) + \mathbf{u}_n(t)\,.\]</p><h3 id="Example:-Resistor"><a class="docs-heading-anchor" href="#Example:-Resistor">Example: Resistor</a><a id="Example:-Resistor-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Resistor" title="Permalink"></a></h3><h3 id="Example:-Capacitor"><a class="docs-heading-anchor" href="#Example:-Capacitor">Example: Capacitor</a><a id="Example:-Capacitor-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Capacitor" title="Permalink"></a></h3><p>Lets look at a more elaborate example: The state-space representation of a simple capacitor.</p><p>From the current-voltage relation of a capacitor</p><p class="math-container">\[v(t) = v_0 + \frac{1}{C} \int_{t_0}^t i(\tau) \text d \tau\]</p><p>we see that a capacitor is not time-dependent due to the integral from time <span>$t_0$</span> to <span>$t$</span> and is said to be a <strong>stateful component</strong>. We have to decide what quantity we want to use as its internal state. In this derivation we will use its voltage, but another viable option would be its charge <span>$Q = v\,C$</span>.</p><p>The <strong>input matrix</strong> <span>$\mathbf{B}$</span> </p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../overview/">« Overview</a><a class="docs-footer-nextpage" href="../../utils/schedules/">Schedules »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.16 on <span class="colophon-date" title="Thursday 22 December 2022 14:04">Thursday 22 December 2022</span>. Using Julia version 1.8.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
